name: Autograding Tests
'on':
- push
- repository_dispatch
permissions:
  checks: write
  actions: read
  contents: read
jobs:
  run-autograding-tests:
    runs-on: ubuntu-latest
    if: github.actor != 'github-classroom[bot]'
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Cache SBT
      uses: actions/cache@v3
      with:
        path: |
          ~/.ivy2/cache
          ~/.sbt
          ~/.coursier/cache
        key: ${{ runner.os }}-sbt-${{ hashFiles('**/build.sbt', 'project/build.properties') }}
        restore-keys: |
          ${{ runner.os }}-sbt-

    - name: Setup SBT
      uses: olafurpg/setup-scala@v14
      with:
        java-version: '17'

    - name: Run tests and generate autograding
      run: sbt autograding

    - name: Autograding Reporter
      uses: education/autograding@v1